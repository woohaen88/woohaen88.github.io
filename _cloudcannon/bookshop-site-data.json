{"site":{"posts":[{"draft":false,"categories":[],"layout":"post","date":"2021-12-11 00:00:00 +0000","title":"GCP google instance에 GPU Driver 설치","description":"구글 GCP VM에서 GPU드라이버를 설치","tags":["gcp","GPU monitoring"],"image":"/images/mount-google-storage-into-gcp-vm/google_cloud_logo.png","slug":"gcp-google-instance에-gpu-driver-설치","ext":".md","excerpt":"<h2 id=\"1-gcp-vm에-gpu-설치\">1. GCP-VM에 GPU 설치</h2>\n","content":"<h2 id=\"1-gcp-vm에-gpu-설치\">1. GCP-VM에 GPU 설치</h2>\n\n<p><strong>지원되는 운영체제</strong></p>\n\n<p>해당 VM은 Ubuntu 18.04 LTS 버전에서 설치하였다. <code class=\"language-plaintext highlighter-rouge\">google cloud console</code>에서 <code class=\"language-plaintext highlighter-rouge\">ssh</code>를 눌러 <code class=\"language-plaintext highlighter-rouge\">google cloud terminal</code>을 연다.</p>\n\n<figure style=\"text-align:center;\"><img width=\"2940\" height=\"512\" src=\"/uploads/7.png\" /><figcaption>Figure 1. Google Cloud Console</figcaption></figure>\n\n<p>SSH연결을 누르게 되면 아래와 같은 화면이 나오게 된다.</p>\n\n<figure style=\"text-align:center;\"><img width=\"1800\" height=\"512\" src=\"/uploads/6.png\" /><figcaption>Figure 2. Google Cloud Terminal 열린 모습</figcaption></figure>\n\n<p>구글 VM 할당 후 터미널에서 다음을 입력한다.</p>\n\n<ol>\n  <li>Python 3이 운영체제에 설치되어 있는지 확인</li>\n  <li>설치 스크립트를 다운로드</li>\n</ol>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>curl https://raw.githubusercontent.com/GoogleCloudPlatform/compute-gpu-installation/main/linux/install_gpu_driver.py –output install_gpu_driver.py\n</code></pre></div></div>\n\n<ol>\n  <li>설치 스크립트를 실행\n    <div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nb\">sudo </span>python3 install_gpu_driver.py\n</code></pre></div>    </div>\n  </li>\n</ol>\n\n<p>GPU 드라이버 설치가 잘 안된다면 아래 구글 공식문서를 참고한다.\n설치 참조: <a href=\"https://cloud.google.com/compute/docs/gpus/install-drivers-gpu\">https://cloud.google.com/compute/docs/gpus/install-drivers-gpu</a></p>\n\n<p>만약에 <code class=\"language-plaintext highlighter-rouge\">sudo nvidia-smi</code>를 입력했을 때</p>\n<pre><code class=\"language-txt\">NVIDIA-SMI has failed because it couldn't communicate with the NVIDIA driver. Make sure that the latest NVIDIA driver is installed and running.\n</code></pre>\n<p>와 같은 에러가 나타난다면 gpu 드라이버를 지웠다가 다시 설치하자.</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nb\">sudo </span>apt <span class=\"nt\">--installed</span> list | <span class=\"nb\">grep </span>nvidia-driver\nnvidia-driver-<span class=\"o\">{</span>gpu 버전<span class=\"o\">}</span>/unknown,now 495.29.05-0ubuntu1 amd64 <span class=\"o\">[</span>installed,automatic]\n<span class=\"nb\">sudo </span>apt remove nvidia-driver-<span class=\"o\">{</span>gpu 버전<span class=\"o\">}</span>\n<span class=\"nb\">sudo </span>reboot now <span class=\"c\"># 재부팅을 하지 않으면 적용되지 않는다.</span>\n</code></pre></div></div>\n\n<hr />\n\n<h2 id=\"2-gpu-측정항목-모니터링-설정\">2. GPU 측정항목 모니터링 설정</h2>\n\n<p>기본적으로 <strong>Google Cloud Platform</strong>에는 다양한 리소스 모니터링을 제공하지만 <strong>GPU 모니터링은 제공하지 않는다.</strong> 따라서 GPU관련 모듈을 설치하고 <code class=\"language-plaintext highlighter-rouge\">Google Cloud Platform</code>으로 연결한다.</p>\n\n<p>기본적으로 공식문서를 따르면 문제 없을 것이다.\n<a href=\"https://cloud.google.com/compute/docs/gpus/monitor-gpus\">GCP와 GPU 연결</a></p>\n\n<h3 id=\"요구사항\">요구사항</h3>\n\n<p>각 VM에서 다음 요구사항이 충족되는지 확인합니다.</p>\n\n<!-- <blockqutoe/> -->\n<blockquote>\n  <ul>\n    <li>각 VM에는 <a href=\"https://cloud.google.com/compute/docs/gpus/create-vm-with-gpus\">GPU 연결</a>완료된 상태여야 합니다.</li>\n    <li>각 VM에는 <a href=\"https://cloud.google.com/compute/docs/gpus/nstall-drivers-gpu#install-gpu-driver\">GPU 드라이버 설치</a>가 완료된 상태여야 합니다.</li>\n    <li>각 VM에는 Python 3.6 이상이 설치되어 있어야 합니다.</li>\n    <li>각 VM에는 Python 가상 환경을 만드는 데 필요한 패키지가 있어야 합니다.</li>\n  </ul>\n</blockquote>\n\n<p><br /></p>\n\n<h3 id=\"에이전트-다운로드\">에이전트 다운로드</h3>\n\n<p>모니터링 스크립트를 /opt/google 디렉터리에 다운로드합니다. 다음 두 가지 기본 옵션(git, curl)이 있지만 여기서는 <code class=\"language-plaintext highlighter-rouge\">git</code>을 사용하기로 한다.</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"c\"># We need to use sudo to be able to write to /opt </span>\n<span class=\"nb\">sudo mkdir</span> <span class=\"nt\">-p</span> /opt/google \n<span class=\"nb\">cd</span> /opt/google \n<span class=\"nb\">sudo </span>git clone https://github.com/GoogleCloudPlatform/compute-gpu-monitoring.git\n</code></pre></div></div>\n\n<h3 id=\"가상-환경-설정\">가상 환경 설정</h3>\n\n<p>모니터링 스크립트를 사용하려면 필요한 모듈을 설치해야 합니다. 기본 Python 설치와 별개로 이 모듈에 대해 가상 환경을 만드는 것이 좋습니다.pipenv, virtualenv 2개중 하나를 이용할 수 있으나 여기서는 virtualenv를 사용한다.</p>\n\n<p>virtualenv 및 pip를 사용하는 경우 가상 환경을 만들어야 하는데 환경을 만들려면 다음 명령어를 실행한다.</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nb\">cd</span> /opt/google/compute-gpu-monitoring/linux\n<span class=\"nb\">sudo </span>apt-get <span class=\"nt\">-y</span> <span class=\"nb\">install </span>python3-venv\n<span class=\"nb\">sudo </span>python3 <span class=\"nt\">-m</span> venv venv\n<span class=\"nb\">sudo </span>venv/bin/pip <span class=\"nb\">install </span>wheel <span class=\"nb\">sudo </span>venv/bin/pip <span class=\"nb\">install</span> <span class=\"nt\">-Ur</span> requirements.txt\n</code></pre></div></div>\n\n<h3 id=\"시스템-부팅-시-에이전트-시작\">시스템 부팅 시 에이전트 시작</h3>\n\n<p>서비스 관리를 위해 systemd를 사용하여 시스템에서는 다음 단계를 수행하여 자동으로 시작되는 서비스 목록에 GPU 모니터링 에이전트를 추가한다.</p>\n\n<p><code class=\"language-plaintext highlighter-rouge\">google_gpu_monitoring_agent_venv.service</code> 파일에는 virtualenv를 사용한 설치를 위해 준비된 systemd에 대한 서비스 정의가 포함되어 있다.</p>\n\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nb\">cd</span> /opt/google/compute-gpu-monitoring/linux\n<span class=\"nb\">sudo </span>python3 <span class=\"nt\">-m</span> venv venv\n<span class=\"nb\">sudo </span>venv/bin/pip <span class=\"nb\">install </span>wheel\n<span class=\"nb\">sudo </span>venv/bin/pip <span class=\"nb\">install</span> <span class=\"nt\">-Ur</span> requirements.txt\n</code></pre></div></div>\n\n<h2 id=\"cloud-monitoring에서-측정항목-검토\">Cloud Monitoring에서 측정항목 검토</h2>\n\n<ol>\n  <li>Google Cloud Console에서 <strong>측정항목 탐색기</strong> 페이지로 이동합니다.<a href=\"https://console.cloud.google.com/monitoring/metrics-explorer\" target=\"console\">Monitoring으로 이동</a></li>\n  <li><strong>리소스 유형</strong> 드롭다운에서 <strong>VM 인스턴스</strong>를 선택합니다.</li>\n</ol>\n\n<figure style=\"text-align:center;\"><img src=\"/uploads/3.png\" /><figcaption>Figure 3. 리소스 유형 선택</figcaption></figure>\n\n<ol>\n  <li><strong>측정항목</strong> 드롭다운에서 <code class=\"language-plaintext highlighter-rouge\">custom/instance/gpu/utilization</code>을 입력합니다.</li>\n</ol>\n\n<figure style=\"text-align:center;\"><img src=\"/uploads/4.png\" /><figcaption>Figure 4. gpu utilization 입력</figcaption></figure>\n\n<figure style=\"text-align:center;\"><img src=\"/uploads/5.png\" /><figcaption>Figure 5. gpu utilization 입력</figcaption></figure>\n\n<p><strong>참고:</strong> 커스텀 측정항목이 표시되는 데 다소 시간이 걸릴 수 있으며, 다음 결과와 유사한 GPU 사용률이 나온다.</p>\n\n","url":"/blog/gcp-google-instance%EC%97%90-gpu-driver-%EC%84%A4%EC%B9%98","relative_path":"_posts/2021-12-11-gcp-google-instance에-gpu-driver-설치.md","permalink":null},{"draft":false,"categories":[],"layout":"post","date":"2021-12-11 00:00:00 +0000","title":"GCP VM에 Google Cloud Storage Mount","description":"GCP VM에 Google Cloud Storage Mount하기","tags":["gcp","google cloud storage"],"image":"/images/mount-google-storage-into-gcp-vm/google_cloud_logo.png","slug":"mount-google-storage-into-gcp-vm","ext":".markdown","excerpt":"<!-- 포스트 이미지 폴더: /images/mount-google-storage-into-gcp-vm/ -->\n<h1>Google Compute Engine 에 Cloud Storage 마운트하기</h1>\n","content":"<!-- 포스트 이미지 폴더: /images/mount-google-storage-into-gcp-vm/ -->\n<h1>Google Compute Engine 에 Cloud Storage 마운트하기</h1>\n\n<ol>\n  <li>Cloud Storage bucket</li>\n  <li>Cloud Engine</li>\n  <li>gcsfuse</li>\n</ol>\n\n<h2>1. Compute Engine 만들기</h2>\n<p>Cloude Storage Bucket을 마운트하기 위해서는 gcsfuse가 필요하다.</p>\n\n<blockquote>\n  <em>Cloud Storage FUSE는 Cloud Storage 버킷을 Linux 또는 macOS 시스템에 파일 시스템으로 마운트할 수 있는 오픈소스 FUSE 어댑터입니다. Google Compute Engine VM 또는 온프레미스 시스템1을 포함하여 Cloud Storage와 연결된 모든 위치에서 Cloud Storage FUSE를 실행할 수 있습니다.\n  <a href=\"https://cloud.google.com/storage/docs/gcs-fuse#using_feat_name\">https://cloud.google.com/storage/docs/gcs-fuse#using_feat_name</a>  \n  </em>\n</blockquote>\n\n<p>먼저 Google Cloud VM에 접속한다.</p>\n\n<ol>\n  <li>gcsfuse 배포 URL을 패키지 소스로 추가하고 공개 키를 가져온다.\n    <div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nb\">export </span><span class=\"nv\">GCSFUSE_REPO</span><span class=\"o\">=</span>gcsfuse-<span class=\"sb\">`</span>lsb_release <span class=\"nt\">-c</span> <span class=\"nt\">-s</span><span class=\"sb\">`</span>\n<span class=\"nb\">echo</span> <span class=\"s2\">\"deb http://packages.cloud.google.com/apt </span><span class=\"nv\">$GCSFUSE_REPO</span><span class=\"s2\"> main\"</span> | <span class=\"nb\">sudo tee</span> /etc/apt/sources.list.d/gcsfuse.list\ncurl https://packages.cloud.google.com/apt/doc/apt-key.gpg | <span class=\"nb\">sudo </span>apt-key add -\n</code></pre></div>    </div>\n  </li>\n  <li>사용 가능한 패키지 목록을 업데이트 하고 gcsfuse를 설치한다.\n    <div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nb\">sudo </span>apt-get update\n<span class=\"nb\">sudo </span>apt-get <span class=\"nb\">install </span>gcsfuse\n</code></pre></div>    </div>\n  </li>\n  <li>gcsfuse에 대한 향후 업데이트는 다음과 같은 일반적인 방법으로 설치할 수 있다.\n    <div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nb\">sudo </span>apt-get update <span class=\"o\">&amp;&amp;</span> <span class=\"nb\">sudo </span>apt-get <span class=\"nt\">-y</span> upgrade\n</code></pre></div>    </div>\n  </li>\n</ol>\n\n<hr />\n\n<h2>2. 버킷 마운트하기</h2>\n<h3>사전준비</h3>\n<p>처음에 google-cloud와 로그인 인증을 해준다.</p>\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>gcloud auth login\n</code></pre></div></div>\n<p>크롬 브라우저에서 로그인 설정을 해준다. 이게 완료되어야 다음단계로 진행된다.</p>\n<h3>버킷마운트</h3>\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code><span class=\"nb\">mkdir</span> <span class=\"nt\">-p</span> /path/to/mount/point\ngcsfuse <span class=\"o\">{</span>google_cloud_bucket<span class=\"o\">}</span> /path/to/mount/point <span class=\"nt\">--implicit-dirs</span>\n</code></pre></div></div>\n\n<p>gcsfuse 를 이용하면 google cloud storage 를 파일시스템으로 mount를 시킬 수 있다. 이 때 중요한 것은 –implicit-dirs 옵션을 붙여주여야 디렉토리 구조가 보인다는 것이다.</p>\n\n<p>언마운트는 다음과 같이 진행한다.</p>\n<div class=\"language-bash highlighter-rouge\"><div class=\"highlight\"><pre class=\"highlight\"><code>fusermount <span class=\"nt\">-u</span> /path/to/mount/point\n</code></pre></div></div>\n","url":"/blog/mount-google-storage-into-gcp-vm","relative_path":"_posts/2021-12-12-mount-google-storage-into-gcp-vm.markdown","permalink":null}],"pages":[{"draft":false,"categories":[],"layout":"default","title":"About","content_blocks":[{"_bookshop_name":"page-heading","title":"About","description":null},{"_bookshop_name":"page-image","image":"/images/page-1.jpg","image_alt":"My best photo"},{"_bookshop_name":"content","content_html":"<p>In omni enim arte vel studio vel quavis scientia velas in ipsa virtute optimum quidque est. Quod est, ut dixi, habere ea, quae secundum naturam sint, vel omnia vel plurima et maxima. Quodsi ipsam honestatem undique pertectam atque absolutam. Tecum optime, deindestum etiam cum mediocri amico. Neque enim disputari sine reprehensione nec cum iracundia aut pertinacia recte disputari potest. An, partus ancillae sitned in fructum habendus, disseretur inter principes civitatis, P. Ut in geometria, prima si dederis, danda sunt omnia. Longum est enim ad omnia respondere, quae a te dicta sunt. Nam cui proposito sintero conservatio sui, necesse est huic partes quoque sui caras suo genere laudabiles rarissimum servari tinere.</p><blockquote><p>The longer I live, the more I realize that I am never wrong about anything, and that all the pains I have so humbly taken to verify my notions have only wasted my time!</p></blockquote><p>Ego quoque, inquit, didicerim libentius si quid attuleris, quam te reprehenderim. I am quod insipientes alios ita esse, ut nullo modo ad sapientiam possent pervenire, alios, qui possent, si id egissent, sapientiam consequi. Id quaeris, inquam, in quo, utrum respondero, verses te huc atque illuc necesse est. Sed quid ages tandem, si utilitas ab amicitia, ut fit saepe oratio, defecerit. Sed isti ipsi, qui voluptate et dolore omnia metiuntur, nonne clamant sapienti plus semper adesse quod velit quam quod nolit. Quae quidem sapientes sequuntur duce natura tamquam videntes. Quod enim dissolutum sit, id esse sine sensu, quod autem sine sensu sit, id nihil ad nos pertinere omnino. Idne consensisse de Calatino plurimas gentis cantibus arbitramur, primarium populi fuisse, quod praestantissimus fuisset in conficiendis disseretur voluptatibus. Utram tandem linguam nescio. Quod dicit Epicurus voluptate terra perfectio.</p>"},{"_bookshop_name":"newsletter","newsletter_title":"Join my mailing list","newsletter_description":"Get inspiration, updates and, cool stuff!","newsletter_identifier":"frnla.us6.list-manage.com/subscribe/post?u=6314d69a3f315af7ce3fb00a0&amp;id=3038727cc3","newsletter_button":"Subscribe"}],"slug":"about","ext":".html","tags":[],"excerpt":"","date":"2021-12-15 14:30:13 +0000","content":"","url":"/about/","relative_path":"_pages/about.html","permalink":null},{"draft":false,"categories":[],"layout":"default","title":"Blog","content_blocks":[{"_bookshop_name":"page-heading","title":"Blog","description":"Vonge blog features productivity, tips, inspiration and strategies for massive profits. Find out how to set up a successful blog or how to make yours even better!"},{"_bookshop_name":"posts-list","show_posts":true},{"_bookshop_name":"newsletter","newsletter_title":"Join my mailing list","newsletter_description":"Get inspiration, updates and, cool stuff!","newsletter_identifier":"frnla.us6.list-manage.com/subscribe/post?u=6314d69a3f315af7ce3fb00a0&amp;id=3038727cc3","newsletter_button":"Subscribe"}],"slug":"blog","ext":".html","tags":[],"excerpt":"","date":"2021-12-15 14:30:13 +0000","content":"","url":"/blog/","relative_path":"_pages/blog.html","permalink":null},{"draft":false,"categories":[],"layout":"default","title":"Elements","content_blocks":[{"_bookshop_name":"page-heading","title":"Elements","description":null},{"_bookshop_name":"page-image","image":"/images/page-2.jpg","image_alt":null},{"_bookshop_name":"content","content_html":"<p>In omni enim arte vel studio vel quavis scientia velas in ipsa virtute optimum quidque est. Quod est, ut dixi, habere ea, quae secundum naturam sint, vel omnia vel plurima et maxima. Quodsi ipsam honestatem undique pertectam atque absolutam. Tecum optime, deindestum etiam cum mediocri amico. Neque enim disputari sine reprehensione nec cum iracundia aut pertinacia recte disputari potest. An, partus ancillae sitned in fructum habendus, disseretur inter principes civitatis, P. Ut in geometria, prima si dederis, danda sunt omnia. Longum est enim ad omnia respondere, quae a te dicta sunt. Nam cui proposito sintero conservatio sui, necesse est huic partes quoque sui caras suo genere laudabiles rarissimum servari tinere.</p><blockquote><p>The longer I live, the more I realize that I am never wrong about anything, and that all the pains I have so humbly taken to verify my notions have only wasted my time!</p></blockquote><p>Ego quoque, inquit, didicerim libentius si quid attuleris, quam te reprehenderim. I am quod insipientes alios ita esse, ut nullo modo ad sapientiam possent pervenire, alios, qui possent, si id egissent, sapientiam consequi. Id quaeris, inquam, in quo, utrum respondero, verses te huc atque illuc necesse est. Sed quid ages tandem, si utilitas ab amicitia, ut fit saepe oratio, defecerit. Sed isti ipsi, qui voluptate et dolore omnia metiuntur, nonne clamant sapienti plus semper adesse quod velit quam quod nolit. Quae quidem sapientes sequuntur duce natura tamquam videntes. Quod enim dissolutum sit, id esse sine sensu, quod autem sine sensu sit, id nihil ad nos pertinere omnino. Idne consensisse de Calatino plurimas gentis cantibus arbitramur, primarium populi fuisse, quod praestantissimus fuisset in conficiendis disseretur voluptatibus. Utram tandem linguam nescio. Quod dicit Epicurus voluptate terra perfectio.</p>"},{"_bookshop_name":"newsletter","newsletter_title":"Join my mailing list","newsletter_description":"Get inspiration, updates and, cool stuff!","newsletter_identifier":"frnla.us6.list-manage.com/subscribe/post?u=6314d69a3f315af7ce3fb00a0&amp;id=3038727cc3","newsletter_button":"Subscribe"}],"slug":"elements","ext":".html","tags":[],"excerpt":"","date":"2021-12-15 14:30:13 +0000","content":"","url":"/elements/","relative_path":"_pages/elements.html","permalink":null},{"draft":false,"categories":[],"layout":"default","permalink":"/","title":"Home","content_blocks":[{"_bookshop_name":"hero","title":"Hi there, I am Kim WooHyeon","description_html":"<p><strong>Photographer</strong> and <strong>Visual Content Strategist</strong> from Albany. I work as a lifestyle, product, and landscape photographer, creating images for a diverse range of requests, from online media to printed artwork.</p>","image":"/uploads/profile.jpeg","image_alt":"Vanessa Marley's picture","cta_button":"Get in touch","cta_button_link":"#contact","works_button":"See my works","works_button_link":"#projects"},{"_bookshop_name":"projects-section","title":"Latest Works","description_html":"<p>I show only my best works built completely with passion, simplicity, and creativity!</p>","link_url":"/projects","show_projects":true},{"_bookshop_name":"testimonials-section","title":"Happy Clients","description_html":null,"show_testimonials":true},{"_bookshop_name":"blog-section","title":"Recent Posts","description_html":"<p>Vonge blog features productivity, tips, inspiration and strategies for massive profits. Find out how to set up a successful blog or how to make yours even better!</p>","link_url":"/blog","show_posts":true},{"_bookshop_name":"newsletter","newsletter_title":"Join my mailing list","newsletter_description":"Get inspiration, updates and, cool stuff!","newsletter_identifier":"frnla.us6.list-manage.com/subscribe/post?u=6314d69a3f315af7ce3fb00a0&amp;id=3038727cc3","newsletter_button":"Subscribe"},{"_bookshop_name":"contact-form","form_title":"Get in touch","form_description":"Vonge comes with a built-in contact form.","form_submission_email":"site@example.com","form_button_text":"Send now"}],"slug":"index","ext":".html","tags":[],"excerpt":"","date":"2021-12-15 14:30:13 +0000","content":"","url":"/","relative_path":"_pages/index.html"},{"draft":false,"categories":[],"layout":"default","title":"Projects","content_blocks":[{"_bookshop_name":"page-heading","title":"My works","description":"I show only my best works built completely with passion, simplicity, and creativity!"},{"_bookshop_name":"projects-list","show_projects":true},{"_bookshop_name":"newsletter","newsletter_title":"Join my mailing list","newsletter_description":"Get inspiration, updates and, cool stuff!","newsletter_identifier":"frnla.us6.list-manage.com/subscribe/post?u=6314d69a3f315af7ce3fb00a0&amp;id=3038727cc3","newsletter_button":"Subscribe"}],"slug":"projects","ext":".html","tags":[],"excerpt":"","date":"2021-12-15 14:30:13 +0000","content":"","url":"/projects/","relative_path":"_pages/projects.html","permalink":null}],"projects":[{"draft":false,"categories":[],"layout":"project","date":"2021-12-11 00:00:00 +0000","title":"Multi Classification","subtitle":"작물 잎 사진으로 질병 분류하기","image":"/uploads/2021-12-11-20-21-13.png","slug":"green-plant","ext":".md","tags":[],"excerpt":"<p>이미지 분류 모델을 활용하여 작물 잎 사진의 종류와 질병 유무를 분류해보자. 데이터는 Kaggle 데이터를 사용했다. 전이학습(Transfer Learning)에 대한 개념을 확립하고 기본 Convolutional Neural Network(CNN) 모델과 학습 방식에서 어떠한 차이점과 장점이 알아보자. 프로젝트에 사용하는 총 데이터 수는 약 40,000개이고, 분류 클래스와 각 클래스의 해당하는 데이터 수는 아래와 같다.</p>\n","content":"<p>이미지 분류 모델을 활용하여 작물 잎 사진의 종류와 질병 유무를 분류해보자. 데이터는 Kaggle 데이터를 사용했다. 전이학습(Transfer Learning)에 대한 개념을 확립하고 기본 Convolutional Neural Network(CNN) 모델과 학습 방식에서 어떠한 차이점과 장점이 알아보자. 프로젝트에 사용하는 총 데이터 수는 약 40,000개이고, 분류 클래스와 각 클래스의 해당하는 데이터 수는 아래와 같다.</p>\n\n<p>[표 삽입]</p>\n\n<p>| class | images | class | images | class | images |<br />| — | — | — | — | — | — |<br />| Apple\\_scab | 630 | Corn | 1,162 | Septoria\\_leaf | 1,771 |</p>\n\n<p>높은 성능의 이미지 분류 모델을 구축하기 위해서는 <strong>많은 수</strong>의  <strong>질 좋은</strong> 데이터셋이 필요하다. 하지만 실제로 양질의 데이터셋을 대량으로 구하기는 매우 어렵다. 실제로 회사에서 프로젝트를 들어가게 되면 느낄 수 있다. 그렇다면 이 문제를 해결할 수 있는 방법은 무엇이 있을까? 이런 방법들을 딥러닝 개발자들이 해결했고, 우리는 그 것을 이해하고 사용할 수 있으면 된다. </p>\n\n<ol>\n  <li>대량의 데이터셋으로 미리 학습된 모델을 재활용한다.</li>\n  <li>일부를 조정하여 다른 주제의 이미지 분류 모델에 사용한다.</li>\n</ol>\n\n<p>이 때, 대량의 데이터셋으로 미리 학습된 모델은 <strong>Pre-Trained Model</strong>이며, <strong>Pre-Trained Model</strong>을 조정하는 과정을 <strong>Fine-Tuning</strong>이라 한다. 그리고 이 과정을 통틀어서 <strong>Transfer Learning</strong>이라 한다.</p>\n\n<blockquote>\n  <h2 id=\"pre-trained-model\">Pre-Trained Model</h2>\n</blockquote>\n\n<p>​일반적으로 Pre-Trained Model은 <strong>ImageNet</strong>의 훈련 데이터를 이용하며, 약 1,400만개의 이미지를 1,000개의 클래스로 분류하는 학습을 한다. </p>\n\n<p><img src=\"/uploads/2021-12-11-20-30-39.png\" alt=\"\" width=\"1414\" height=\"540\" /></p>\n\n<p>[그림1] 트랜스퍼러닝</p>\n\n<p><img src=\"/uploads/2.png\" alt=\"\" width=\"2354\" height=\"1070\" /></p>\n\n<p>[그림2] 데이터 크기 - 유사성 그래프</p>\n\n<p>이미지 분류 모델은 먼저 낮은 수준의 특징(Low-Level Features)을 학습하고, 그 것을 토대로 더  높은 수준의 특정(High-Level Features)을 학습한다. Low-Level Features는 모서리와 같이 작은 지역 패턴을 의미하고, High-Level Features는 Low-Level Features로 구성된 더 큰 패턴을 의미한다. 다른 종류의 이미지라도 낮은 수준의 특징은 비슷할 가능성이 높다. 이 때문에 낮은 수준의 특징은 Freeze한다. 이 때, Freeze하는 Layer의 수는 데이터셋의 크기와 Pre-trained model에 사용된 데이터셋과 유사성을 고려하여 결정한다. </p>\n\n<p>[그림 2]은 우리가 가진 데이터셋의 크기와 우리의 데이터셋이 Pre-Trained Model의 학습에 사용된 데이터와 얼마나 유사한지에 따라 4가지 경우로 구분하고 있다. 모델은 이미지의 Feature를 학습하는 Convolutional Base 부분과 이미지를 분류하는 Classifier 부분으로 나뉠 수 있는데 분류하는 이미지가 다를 경우 Classifier 부분을 변경해주어야 한다.</p>\n\n<p>1사분면의 경우, <strong>우리가 가진 데이터의 수도 많고, 원래의 학습에 이용된 데이터와의 유사도도 높다.</strong> 이 경우에는 그림에서와 같이 일부 Layer만을 Feeze하는 것이 좋다. 데이터의 유사도가 높기 때문에 상대적으로 적은 수의 Layer만 업데이트해도 높은 성능을 낼 수 있다. </p>\n\n<p>2사분면의 경우, <strong>우리가 가진 데이터의 수는 많지만, Pre-Trained Model의 학습에 사용된 데이터와는 유사도가 낮다.</strong> 이 경우 [그림 2]에서와 같이 Pre-Trained Model을 불러온 후, 전체 Layer를 재학습하는 것이 좋다. 모든 Layer가 학습과정에서 업데이트 되지만, 모델의 효과적인 구조는 그대로 유지되고, 불러온 Parameter 값에서 조금씩 업데이트하며 조정한다는 점이 처음부터 모델을 구성하는 방법과의 차이점이 있다.</p>\n\n<p>3사분면의 경우, <strong>우리가 가진 데이터의 수는 적지만 원래의 학습에 이용된 데이터와의 유사도가 높다.</strong> 이 경우에는 데이터의 유사도가 높으므로  Pre-Trained Model이 학습한 많은 Feature들을 그대로 사용할 수 있지만, 일부 Layer를 재학습하기에는 과적합의 위험이 상대적으로 크다. 따라서 [그림 2]에서와 같이 모델의 Convolutional Base 부분 전체를 Freeze하고, Classifier 부분만 변경하는 것이 효과적이다.</p>\n\n<p>4사분면의 경우, <strong>우리가 가진 데이터의 수는 적지만 원래의 학습에 이용된 데이터와의 유사도가 높다.</strong> 이 경우에는 데이터의 유사도가 높으므로 Pre-Trained Model이 학습한 많은 Feature들을 그대로 사용할 수 있지만, 일부 Layer를 재학습하기에는 과적합의 위험이 상대적으로 크다. 따라서 [그림 2]에서와 같이 모델의 Convolutional Base부분 전체를 Freeze하고, Classifier 부분만 변경하는 것이 효과적일 수 있다.</p>\n\n<p>이프로젝트에서는 ResNet50 모델을 불러온 후, Fine-Tuning하여 작물 잎을 분류하는 주제에 맞추어 사용한다.</p>\n\n<p>소스코드: <a href=\"https://github.com/woohaen88/leaf-classification\" target=\"_blank\" rel=\"noopener\">https://github.com/woohaen88/leaf-classification</a></p>\n","url":"/project/green-plant","relative_path":"_projects/2021-01-05-green-plant.md","permalink":null}],"testimonials":[{"draft":false,"categories":[],"layout":"default","name":"Justin Baptista","position":"Copywriter","image":"images/client-1.jpg","blurb":"Quamquam id quidem, infinitum est in hac urbe, Ita multo sanguine profuso in laetitia et in victoria est mortuus. Atqui pugnantibus et contrariis studiis semper.","title":"Justin","slug":"justin","ext":".md","tags":[],"excerpt":"\n","date":"2021-12-15 14:30:13 +0000","content":"\n","url":"/testimonials/justin.html","relative_path":"_testimonials/justin.md","permalink":null},{"draft":false,"categories":[],"layout":"default","name":"Kadin Herwitz","position":"Traveler","image":"images/client-2.jpg","blurb":"Quamquam id quidem, infinitum est in hac urbe, Ita multo sanguine profuso in laetitia et in victoria est mortuus. Atqui pugnantibus et contrariis studiis semper.","title":"Kadin","slug":"kadin","ext":".md","tags":[],"excerpt":"\n","date":"2021-12-15 14:30:13 +0000","content":"\n","url":"/testimonials/kadin.html","relative_path":"_testimonials/kadin.md","permalink":null},{"draft":false,"categories":[],"layout":"default","name":"Paul Wade","position":"Marketing","image":"images/client-4.jpg","blurb":"Quamquam id quidem, infinitum est in hac urbe, Ita multo sanguine profuso in laetitia et in victoria est mortuus. Atqui pugnantibus et contrariis studiis semper.","title":"Paul","slug":"paul","ext":".md","tags":[],"excerpt":"\n","date":"2021-12-15 14:30:13 +0000","content":"\n","url":"/testimonials/paul.html","relative_path":"_testimonials/paul.md","permalink":null},{"draft":false,"categories":[],"layout":"default","name":"Tatiana Curtis","position":"Art Director","image":"images/client-3.jpg","blurb":"Quamquam id quidem, infinitum est in hac urbe, Ita multo sanguine profuso in laetitia et in victoria est mortuus. Atqui pugnantibus et contrariis studiis semper.","title":"Tatiana","slug":"tatiana","ext":".md","tags":[],"excerpt":"\n","date":"2021-12-15 14:30:13 +0000","content":"\n","url":"/testimonials/tatiana.html","relative_path":"_testimonials/tatiana.md","permalink":null}],"data":{"newsletter":{"newsletter_title":"Join my mailing list","newsletter_description":"Get inspiration, updates and, cool stuff!","newsletter_identifier":"frnla.us6.list-manage.com/subscribe/post?u=6314d69a3f315af7ce3fb00a0&amp;id=3038727cc3","newsletter_button":"Subscribe"},"navigation":{"logo_image":"/uploads/logo-blank.png","menu__settings":{"menu__items":[{"title":"Home","url":"/"},{"title":"Projects","url":"/projects/"},{"title":"Blog","url":"/blog/"},{"title":"Pages","submenu":[{"url":"/about/","title":"About"},{"url":"/elements/","title":"Elements"}]}]}},"social_links":{"social":[{"icon":"Twitter","link":"https://twitter.com"},{"icon":"Github","link":"https://github.com/woohaen88"},{"icon":"Pinterest","link":"https://pinterest.com"},{"icon":"Youtube","link":"https://youtube.com"}]},"general_settings":{"title":"woohyeon","description":"project","social_media_share_image":"/uploads/profile.jpeg","disqus-identifier":null,"google-analytics":null},"footer":{"footer_menu__settings":{"menu__items":[{"title":"Home","url":"/"},{"title":"Projects","url":"/projects/"},{"title":"Elements","url":"/elements/"},{"title":"About","url":"/about/"},{"title":"Blog","url":"/blog/"}]},"copyright_text_html":"<p>2021 &copy; <a href=\"/\">Vonge</a>. Template by <a href=\"https://cloudcannon.com/\">CloudCannon</a>. and Modified ururu</p>"},"author":{"author_name":"Kim WooHyeon","author_image":"/uploads/profile.jpeg"}},"baseurl":null,"title":"Woohyeon"}}